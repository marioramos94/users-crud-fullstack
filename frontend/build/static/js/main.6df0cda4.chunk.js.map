{"version":3,"sources":["Context.js","config/index.js","api/index.js","components/UserTable.js","components/AddUserForm.js","components/EditYo.js","pages/UsersPage.js","components/OktaSignInWidget.js","pages/Login.js","index.js","App.js"],"names":["Context","createContext","require","config","clientId","process","issuer","redirectUri","pkce","API_URI","uri","UserTable","useContext","setUsers","users","editRow","deleteUser","id","axios","delete","headers","Authorization","window","sessionStorage","getItem","deleteApiUser","then","filter","user","length","map","key","firstName","lastName","email","className","onClick","colSpan","AddUserForm","useForm","register","errors","handleSubmit","addUser","uuidv4","post","createUser","catch","e","console","log","onSubmit","data","target","reset","type","name","ref","required","value","message","username","EditYo","currentUser","setEditing","defaultValues","setValue","updateUser","updatedUser","put","updateApiUser","UsersPage","removeAuth","editing","useEffect","get","result","widgetConfig","baseUrl","split","logo","i18n","en","authParams","display","responseMode","scopes","OktaSignInWidget","onSuccess","onError","widgetRef","useRef","current","widget","OktaSignIn","showSignInToGetTokens","el","remove","Login","activateAuth","response","token","accessToken","err","ReactDOM","render","children","useState","isAuth","setIsAuth","setCurrentUser","setItem","removeItem","Provider","document","getElementById"],"mappings":"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","file":"static/js/main.6df0cda4.chunk.js","sourcesContent":["import React, { createContext, useState } from \"react\";\nexport const Context = createContext();\n\nconst Provider = ({ children }) => {\n  const [isAuth, setIsAuth] = useState(() => {\n    return window.sessionStorage.getItem('token')\n  });\n  const [users, setUsers] = useState([]);\n  const [currentUser, setCurrentUser] = useState({ id: null, firstName: '', lastName: '', email: '' })\n  const [editing, setEditing] = useState(false)\n  const editRow = user => {\n    setEditing(true)\n    setCurrentUser({ id: user.id, firstName: user.firstName, lastName: user.lastName, email: user.email })\n  }\n  const value = {\n    isAuth,\n    users,\n    setUsers,\n    currentUser,\n    setCurrentUser,\n    editing,\n    editRow,\n    setEditing,\n    activateAuth: (token) => {\n      setIsAuth(true)\n      window.sessionStorage.setItem('token', token)\n    },\n    removeAuth: () => {\n      setIsAuth(false)\n      window.sessionStorage.removeItem('token')\n    }\n  }\n  return (\n    <Context.Provider value={value}>\n      {children}\n    </Context.Provider>\n  )\n};\nconst Consumer = ({ children }) => {\n\n  return (\n    <Context.Consumer >\n      {children}\n    </Context.Consumer>\n  )\n};\nexport { Consumer, Provider, Context as default };\n","require('dotenv').config()\nexport default {\n  oidc: {\n    clientId: process.env.REACT_APP_OKTA_CLIENT_ID,\n    issuer: process.env.REACT_APP_OKTA_ISSUER,\n    redirectUri: process.env.REACT_APP_OKTA_REDIRECT_URI,\n    pkce: true\n  },\n  api:{\n    uri:process.env.REACT_APP_API_URI,\n  }\n}\n","import axios from 'axios';\nimport config from './../config'\nconst API_URI = config.api.uri\nexport const listAllUsers = () => axios.get(`${API_URI}/list`, {\n  headers: { Authorization: `Bearer ${window.sessionStorage.getItem('token')}` }\n})\n\nexport const getUser = (id) => axios.get(`${API_URI}/get/${id}`, {\n  headers: { Authorization: `Bearer ${window.sessionStorage.getItem('token')}` }\n})\n\nexport const deleteApiUser = (id) => axios.delete(`${API_URI}/delete/${id}`, {\n  headers: { Authorization: `Bearer ${window.sessionStorage.getItem('token')}` }\n})\n\nexport const updateApiUser = (id, user) => axios.put(`${API_URI}/update/${id}`, user, {\n  headers: { Authorization: `Bearer ${window.sessionStorage.getItem('token')}` }\n})\n\nexport const createUser = (user) => axios.post(`${API_URI}/create`, user, {\n  headers: { Authorization: `Bearer ${window.sessionStorage.getItem('token')}` }\n})\n\n","import React, { useContext } from 'react'\nimport Context from \"./../Context\";\nimport { deleteApiUser } from './../api';\nconst UserTable = () => {\n  const { setUsers, users, editRow } = useContext(Context)\n  const deleteUser = id => {\n    deleteApiUser(id).then(() => {\n      setUsers(users.filter(user => user.id !== id))\n    })\n  }\n  return (\n    <table>\n      <thead>\n        <tr>\n          <th>First Name</th>\n          <th>Last Name </th>\n          <th>Email</th>\n          <th>Actions</th>\n        </tr>\n      </thead>\n      <tbody>\n        {\n          users.length > 0 ? (\n            users.map(user => (\n              <tr key={user.id}>\n                <td>{user.firstName}</td>\n                <td>{user.lastName}</td>\n                <td>{user.email}</td>\n                <td>\n                  <button\n                    className=\"button muted-button\"\n                    onClick={() => {\n                      editRow(user)\n                    }}\n                  >\n                    Edit\n                  </button>\n                  <button\n                    className=\"button muted-button\"\n                    onClick={() => deleteUser(user.id)}\n                  >\n                    Delete\n                  </button>\n                </td>\n              </tr>\n            ))\n          ) : (\n            <tr>\n              <td colSpan={3}>No users</td>\n            </tr>\n          )\n        }\n      </tbody>\n    </table>\n  )\n}\n\nexport default UserTable\n","import React, { useContext } from 'react';\nimport { useForm } from 'react-hook-form'\nimport Context from \"./../Context\";\nimport { v4 as uuidv4 } from 'uuid';\nimport { createUser } from './../api'\nconst AddUserForm = () => {\n  const { setUsers, users } = useContext(Context)\n  const { register, errors, handleSubmit } = useForm();\n  const addUser = (user) => {\n    user.id = uuidv4()\n    createUser(user).then(() => {\n      setUsers([\n        ...users,\n        user\n      ])\n    }).catch((e) => {\n      console.log({ e })\n    })\n  }\n  const onSubmit = (data, e) => {\n    data.id = null\n    addUser(data)\n    e.target.reset();\n  }\n  return (\n    <form onSubmit={handleSubmit(onSubmit)}>\n      <label>First Name</label>\n      <input\n        type=\"text\"\n        name=\"firstName\"\n        ref={register({ required: { value: true, message: 'Valor requerido' } })}\n      />\n      <div>\n        {errors?.name?.message}\n      </div>\n      <label>Last Name</label>\n      <input\n        type=\"text\"\n        name=\"lastName\"\n        ref={register({ required: { value: true, message: 'Valor requerido' } })}\n      />\n      <div>\n        {errors?.username?.message}\n      </div>\n      <label>Email</label>\n      <input\n        type=\"email\"\n        name=\"email\"\n        ref={register({ required: { value: true, message: 'Valor requerido' } })}\n      />\n      <div>\n        {errors?.username?.message}\n      </div>\n      <button type=\"submit\">Add new user</button>\n    </form>\n  );\n}\n\nexport default AddUserForm;\n","import React, { useContext } from 'react'\nimport { useForm } from 'react-hook-form'\nimport Context from \"./../Context\";\nimport { updateApiUser } from './../api';\nconst EditYo = () => {\n  const { setUsers, users, currentUser, setEditing } = useContext(Context)\n  const { register, errors, handleSubmit, setValue } = useForm({\n    defaultValues: currentUser\n  });\n  setValue('firstName', currentUser.firstName)\n  setValue('lastName', currentUser.lastName)\n  setValue('email', currentUser.email)\n  const updateUser = (id, updatedUser) => {\n    setEditing(false)\n    updateApiUser(id, updatedUser).then(() => {\n      setUsers(users.map(user => (user.id === id ? updatedUser : user)))\n    })\n  }\n  const onSubmit = (data, e) => {\n    data.id = currentUser.id\n    updateUser(currentUser.id, data)\n    e.target.reset()\n  }\n  return (\n    <form onSubmit={handleSubmit(onSubmit)}>\n      <label>First Name</label>\n      <input\n        type=\"text\"\n        name=\"firstName\"\n        ref={register({ required: { value: true, message: 'Valor requerido' } })}\n      />\n      <div>\n        {errors?.name?.message}\n      </div>\n      <label>Last Name</label>\n      <input\n        type=\"text\"\n        name=\"lastName\"\n        ref={register({ required: { value: true, message: 'Valor requerido' } })}\n      />\n      <div>\n        {errors?.name?.message}\n      </div>\n      <label>Email</label>\n      <input\n        type=\"email\"\n        name=\"email\"\n        ref={register({ required: { value: true, message: 'Valor requerido' } })}\n      />\n      <div>\n        {errors?.username?.message}\n      </div>\n      <button type=\"submit\">Edit user</button>\n      <button onClick={() => setEditing(false)} className=\"button muted-button\">\n        Cancel\n      </button>\n    </form>\n  );\n}\n\nexport default EditYo;\n","import React, {  useEffect, useContext } from 'react';\nimport UserTable from './../components/UserTable';\nimport AddUserForm from './../components/AddUserForm';\nimport EditYo from './../components/EditYo';\nimport { listAllUsers } from './../api'\nimport Context from \"./../Context\";\n\nexport const UsersPage = () => {\n  const { removeAuth, setUsers, editing } = useContext(Context)\n  useEffect(() => {\n    listAllUsers().then((result) => {\n      setUsers(result.data)\n    }).catch((e)=>{\n      console.log(e)\n    })\n  },[setUsers])\n  return (\n    <div className=\"container\">\n      <div className=\"row\" >\n        <button onClick={removeAuth}>Logout</button>\n      </div>\n      <h1>Serverless User CRUD</h1>\n      <p>Backend: DynamoDB - C# on Lambda - API Gateway </p>\n      <p>Frontend: Reactjs Spa- Hosted on Firebase </p>\n      <p>Backend Deploy: Serverless Framework</p>\n      <p>Frontend Deploy: Firebase tools</p>\n      <div className=\"flex-row\">\n        <div className=\"flex-large\">\n        {editing ? (\n          <div>\n            <h2>Edit user</h2>\n            <EditYo />\n          </div>\n        ) : (\n          <div>\n            <h2>Add user</h2>\n            <AddUserForm />\n          </div>\n        )}\n      </div>\n        <div className=\"flex-large\">\n          <h2>View users</h2>\n          <UserTable />\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect, useRef } from 'react';\nimport OktaSignIn from '@okta/okta-signin-widget';\nimport '@okta/okta-signin-widget/dist/css/okta-sign-in.min.css';\nimport config from './../config';\nconst { pkce, issuer, clientId, redirectUri } = config.oidc;\nconst widgetConfig = {\n    baseUrl: issuer.split('/oauth2')[0],\n    clientId,\n    redirectUri,\n    logo: '/logo.svg',\n    i18n: {\n      en: {\n        'primaryauth.title': 'Sign in to React & Company',\n      },\n    },\n    authParams: {\n      pkce,\n      issuer,\n      display: 'page',\n      responseMode: pkce ? 'query' : 'fragment',\n      scopes:['openid', 'profile', 'email']\n    },\n  }\nexport const OktaSignInWidget = ({ onSuccess, onError }) => {\n  const widgetRef = useRef();\n  useEffect(() => {\n    if (!widgetRef.current)\n      return false;\n    const widget = new OktaSignIn(widgetConfig);\n    widget.showSignInToGetTokens({\n      el: widgetRef.current,\n    }).then(onSuccess).catch(onError);\n    return () => widget.remove();\n  }, [ onSuccess, onError]);\n  return (<div ref={widgetRef} />);\n};\n","import React, { useContext } from 'react';\nimport { OktaSignInWidget } from '../components/OktaSignInWidget'\nimport Context from \"../Context\";\n\nexport const Login = ()=>{\n    const { activateAuth } = useContext(Context)\n    const onSuccess = (response) => {\n        let token = response.accessToken.value\n        activateAuth(token)\n    }\n    const onError = (err) => {\n        throw err;\n    }\n    return <OktaSignInWidget onSuccess={onSuccess} onError = {onError} ></OktaSignInWidget>\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport { App } from './App';\nimport { Provider } from \"./Context\";\n\nReactDOM.render(<Provider >\n    <App />\n</Provider>, document.getElementById('root'));\n\n","import React, { useContext } from 'react';\nimport { UsersPage } from './pages/UsersPage';\nimport { Login } from './pages/Login';\nimport Context from './Context';\n\nexport const App = () => {\nconst { isAuth = false  } = useContext(Context);\nreturn  isAuth? <UsersPage/> : <Login/>\n};\n"],"sourceRoot":""}