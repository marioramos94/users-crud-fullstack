(this["webpackJsonpcrud-2"]=this["webpackJsonpcrud-2"]||[]).push([[0],{20:function(e,t,a){e.exports=a(50)},25:function(e,t,a){},50:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(18),u=a.n(l),i=(a(25),a(4)),o=Object(n.createContext)(),c=a(5),s=a.n(c);a(43).config();var m={clientId:"0oa19gu0v67eRndCW5d7",issuer:"https://dev-11650317.okta.com/oauth2/default",redirectUri:"https://users-crud-mario-ramos.web.app/",pkce:!0},d={uri:"https://azvztqqmej.execute-api.us-east-1.amazonaws.com"}.uri,E=function(){var e=Object(n.useContext)(o),t=e.setUsers,a=e.users,l=e.editRow,u=function(e){(function(e){return s.a.delete("".concat(d,"/delete/").concat(e),{headers:{Authorization:"Bearer ".concat(window.sessionStorage.getItem("token"))}})})(e).then((function(){t(a.filter((function(t){return t.id!==e})))}))};return r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"First Name"),r.a.createElement("th",null,"Last Name "),r.a.createElement("th",null,"Email"),r.a.createElement("th",null,"Actions"))),r.a.createElement("tbody",null,a.length>0?a.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,e.firstName),r.a.createElement("td",null,e.lastName),r.a.createElement("td",null,e.email),r.a.createElement("td",null,r.a.createElement("button",{className:"button muted-button",onClick:function(){l(e)}},"Edit"),r.a.createElement("button",{className:"button muted-button",onClick:function(){return u(e.id)}},"Delete")))})):r.a.createElement("tr",null,r.a.createElement("td",{colSpan:3},"No users"))))},f=a(2),v=a(7),b=a(52),p=function(){var e,t,a,l=Object(n.useContext)(o),u=l.setUsers,i=l.users,c=Object(v.a)(),m=c.register,E=c.errors,p=c.handleSubmit,g=function(e){e.id=Object(b.a)(),function(e){return s.a.post("".concat(d,"/create"),e,{headers:{Authorization:"Bearer ".concat(window.sessionStorage.getItem("token"))}})}(e).then((function(){u([].concat(Object(f.a)(i),[e]))})).catch((function(e){console.log({e:e})}))};return r.a.createElement("form",{onSubmit:p((function(e,t){e.id=null,g(e),t.target.reset()}))},r.a.createElement("label",null,"First Name"),r.a.createElement("input",{type:"text",name:"firstName",ref:m({required:{value:!0,message:"Valor requerido"}})}),r.a.createElement("div",null,null===E||void 0===E||null===(e=E.name)||void 0===e?void 0:e.message),r.a.createElement("label",null,"Last Name"),r.a.createElement("input",{type:"text",name:"lastName",ref:m({required:{value:!0,message:"Valor requerido"}})}),r.a.createElement("div",null,null===E||void 0===E||null===(t=E.username)||void 0===t?void 0:t.message),r.a.createElement("label",null,"Email"),r.a.createElement("input",{type:"email",name:"email",ref:m({required:{value:!0,message:"Valor requerido"}})}),r.a.createElement("div",null,null===E||void 0===E||null===(a=E.username)||void 0===a?void 0:a.message),r.a.createElement("button",{type:"submit"},"Add new user"))},g=function(){var e,t,a,l=Object(n.useContext)(o),u=l.setUsers,i=l.users,c=l.currentUser,m=l.setEditing,E=Object(v.a)({defaultValues:c}),f=E.register,b=E.errors,p=E.handleSubmit,g=E.setValue;g("firstName",c.firstName),g("lastName",c.lastName),g("email",c.email);var h=function(e,t){m(!1),function(e,t){return s.a.put("".concat(d,"/update/").concat(e),t,{headers:{Authorization:"Bearer ".concat(window.sessionStorage.getItem("token"))}})}(e,t).then((function(){u(i.map((function(a){return a.id===e?t:a})))}))};return r.a.createElement("form",{onSubmit:p((function(e,t){e.id=c.id,h(c.id,e),t.target.reset()}))},r.a.createElement("label",null,"First Name"),r.a.createElement("input",{type:"text",name:"firstName",ref:f({required:{value:!0,message:"Valor requerido"}})}),r.a.createElement("div",null,null===b||void 0===b||null===(e=b.name)||void 0===e?void 0:e.message),r.a.createElement("label",null,"Last Name"),r.a.createElement("input",{type:"text",name:"lastName",ref:f({required:{value:!0,message:"Valor requerido"}})}),r.a.createElement("div",null,null===b||void 0===b||null===(t=b.name)||void 0===t?void 0:t.message),r.a.createElement("label",null,"Email"),r.a.createElement("input",{type:"email",name:"email",ref:f({required:{value:!0,message:"Valor requerido"}})}),r.a.createElement("div",null,null===b||void 0===b||null===(a=b.username)||void 0===a?void 0:a.message),r.a.createElement("button",{type:"submit"},"Edit user"),r.a.createElement("button",{onClick:function(){return m(!1)},className:"button muted-button"},"Cancel"))},h=function(){var e=Object(n.useContext)(o),t=e.removeAuth,a=e.setUsers,l=e.editing;return Object(n.useEffect)((function(){s.a.get("".concat(d,"/list"),{headers:{Authorization:"Bearer ".concat(window.sessionStorage.getItem("token"))}}).then((function(e){a(e.data)})).catch((function(e){console.log(e)}))}),[a]),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("button",{onClick:t},"Logout")),r.a.createElement("h1",null,"Serverless User CRUD"),r.a.createElement("p",null,"Backend: DynamoDB - C# on Lambda - API Gateway "),r.a.createElement("p",null,"Frontend: Reactjs Spa- Hosted on Firebase "),r.a.createElement("p",null,"Backend Deploy: Serverless Framework"),r.a.createElement("p",null,"Frontend Deploy: Firebase tools"),r.a.createElement("div",{className:"flex-row"},r.a.createElement("div",{className:"flex-large"},l?r.a.createElement("div",null,r.a.createElement("h2",null,"Edit user"),r.a.createElement(g,null)):r.a.createElement("div",null,r.a.createElement("h2",null,"Add user"),r.a.createElement(p,null))),r.a.createElement("div",{className:"flex-large"},r.a.createElement("h2",null,"View users"),r.a.createElement(E,null))))},N=a(19),w=a.n(N),j=(a(49),m),k=j.pkce,S=j.issuer,O=j.clientId,y=j.redirectUri,C={baseUrl:S.split("/oauth2")[0],clientId:O,redirectUri:y,logo:"/logo.svg",i18n:{en:{"primaryauth.title":"Sign in to React & Company"}},authParams:{pkce:k,issuer:S,display:"page",responseMode:k?"query":"fragment",scopes:["openid","profile","email"]}},x=function(e){var t=e.onSuccess,a=e.onError,l=Object(n.useRef)();return Object(n.useEffect)((function(){if(!l.current)return!1;var e=new w.a(C);return e.showSignInToGetTokens({el:l.current}).then(t).catch(a),function(){return e.remove()}}),[t,a]),r.a.createElement("div",{ref:l})},q=function(){var e=Object(n.useContext)(o).activateAuth;return r.a.createElement(x,{onSuccess:function(t){var a=t.accessToken.value;e(a)},onError:function(e){throw e}})};u.a.render(r.a.createElement((function(e){var t=e.children,a=Object(n.useState)((function(){return window.sessionStorage.getItem("token")})),l=Object(i.a)(a,2),u=l[0],c=l[1],s=Object(n.useState)([]),m=Object(i.a)(s,2),d=m[0],E=m[1],f=Object(n.useState)({id:null,firstName:"",lastName:"",email:""}),v=Object(i.a)(f,2),b=v[0],p=v[1],g=Object(n.useState)(!1),h=Object(i.a)(g,2),N=h[0],w=h[1],j={isAuth:u,users:d,setUsers:E,currentUser:b,setCurrentUser:p,editing:N,editRow:function(e){w(!0),p({id:e.id,firstName:e.firstName,lastName:e.lastName,email:e.email})},setEditing:w,activateAuth:function(e){c(!0),window.sessionStorage.setItem("token",e)},removeAuth:function(){c(!1),window.sessionStorage.removeItem("token")}};return r.a.createElement(o.Provider,{value:j},t)}),null,r.a.createElement((function(){var e=Object(n.useContext)(o).isAuth;return void 0!==e&&e?r.a.createElement(h,null):r.a.createElement(q,null)}),null)),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.6df0cda4.chunk.js.map